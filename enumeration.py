#!/usr/bin/env python

# This script enumerates information from the local system

import ctypes
import socket
import string
import subprocess


# Enumerate IP addresses and hostname
host, alias, ip = socket.gethostbyname_ex(socket.gethostname())

# Get full hostname (including domain if applicable)
host = socket.getfqdn()

# Enumerate system drives
drive_space = {}
drives = []
bitmask = ctypes.windll.kernel32.GetLogicalDrives()
for letter in string.uppercase:
    if bitmask & 1:
        drives.append(letter)
    bitmask >>= 1

# http://stackoverflow.com/questions/51658/cross-platform-space-remaining-on-volume-using-python
# Get space per drive
for drive_letter in drives:
    free_bytes = ctypes.c_ulonglong(0)
    ctypes.windll.kernel32.GetDiskFreeSpaceExW(ctypes.c_wchar_p(drive_letter + ":"), None, None, ctypes.pointer(free_bytes))
    free_megs = free_bytes.value / 1024 / 1024
    drive_space[drive_letter] = free_megs

# Get running processes
tasklist_output = subprocess.Popen("tasklist", shell=True, stdout=subprocess.pipe)
process_list = ''
for proc in tasklist_output:
    process_list += proc
